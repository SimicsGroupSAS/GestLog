<UserControl x:Class="GestLog.Views.Tools.GestionCartera.GestionCarteraView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:converters="clr-namespace:GestLog.Converters"
             xmlns:controls="clr-namespace:GestLog.Controls"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="800">
    
    <UserControl.Resources>
        <converters:PathToFileNameConverter x:Key="PathToFileNameConverter"/>
        <converters:FileSizeConverter x:Key="FileSizeConverter"/>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:BooleanToColorConverter x:Key="BooleanToColorConverter"/>
        <converters:BooleanToStatusTextConverter x:Key="BooleanToStatusTextConverter"/>
        <converters:InverseBooleanConverter x:Key="InverseBooleanConverter"/>
        <converters:ProgressToWidthConverter x:Key="ProgressToWidthConverter"/>
        
        <!-- Estilo para botÃ³n de acento verde -->
        <Style x:Key="AccentButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#118938"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect Color="#000000" 
                                                BlurRadius="4" 
                                                ShadowDepth="1" 
                                                Opacity="0.12"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#2B8E3F"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#0F7A30"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- Estilo para botÃ³n secundario -->
        <Style x:Key="SecondaryButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#706F6F"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect Color="#000000" 
                                                BlurRadius="4" 
                                                ShadowDepth="1" 
                                                Opacity="0.12"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#5A5959"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#4A4949"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>        <!-- Estilo para GroupBox con tema verde -->
        <Style x:Key="GreenGroupBoxStyle" TargetType="GroupBox">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#118938"/>
            <Setter Property="BorderBrush" Value="#E5E5E5"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Margin" Value="0,0,0,15"/>
            <Setter Property="Padding" Value="15"/>
        </Style>
        
        <!-- Estilo para botones de cancelar -->
        <Style x:Key="CancelButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#DC3545"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <Border.Effect>
                                <DropShadowEffect Color="#000000" 
                                                BlurRadius="4" 
                                                ShadowDepth="1" 
                                                Opacity="0.15"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#C82333"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#BD2130"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Background" Value="#6C757D"/>
                                <Setter Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources><Grid Background="#FAFAFA">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Contenido principal con scroll -->
        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto" Padding="40,30,40,20">
            <StackPanel>
                
                <!-- Header -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,30">
                    <Border Background="White" Width="80" Height="80" CornerRadius="40" 
                            HorizontalAlignment="Center" Margin="0,0,20,0"
                            BorderBrush="#E5E5E5" BorderThickness="2">
                        <Border.Effect>
                            <DropShadowEffect Color="#000000" 
                                            BlurRadius="8" 
                                            ShadowDepth="2" 
                                            Opacity="0.10"/>
                        </Border.Effect>
                        <TextBlock Text="ðŸ“§" FontFamily="Segoe UI" FontSize="40" 
                                  Foreground="#118938" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="GestiÃ³n de Cartera" 
                                  FontFamily="Segoe UI" FontSize="28" FontWeight="SemiBold" 
                                  Foreground="#118938" Margin="0,0,0,8"/>
                        <TextBlock Text="EnvÃ­o de correos electrÃ³nicos de cartera vencida" 
                                  FontFamily="Segoe UI" FontSize="16" 
                                  Foreground="#706F6F"/>
                    </StackPanel>
                </StackPanel>

          <!-- Contenido principal con pestaÃ±as -->
        <TabControl x:Name="mainTabControl" Background="Transparent" BorderThickness="0">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="FontFamily" Value="Segoe UI"/>
                    <Setter Property="FontSize" Value="14"/>
                    <Setter Property="FontWeight" Value="SemiBold"/>
                    <Setter Property="Padding" Value="20,12"/>
                    <Setter Property="Foreground" Value="#504F4E"/>
                    <Setter Property="Background" Value="White"/>
                    <Setter Property="BorderBrush" Value="#E5E5E5"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border Name="Border" Background="{TemplateBinding Background}" 
                                        BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="1,1,1,0" 
                                        Margin="2,0" CornerRadius="8,8,0,0">
                                    <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" 
                                                     HorizontalAlignment="Center" ContentSource="Header" 
                                                     Margin="{TemplateBinding Padding}"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="#118938"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Border" Property="Background" Value="#E8F5E8"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.Resources>
            
            <!-- Primera pestaÃ±a: GeneraciÃ³n de Documentos -->
            <TabItem Header="ðŸ“„ GeneraciÃ³n de Documentos">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                          <!-- ConfiguraciÃ³n de Archivos -->
                        <GroupBox Header="ðŸ“ ConfiguraciÃ³n de Archivos" 
                                  Style="{StaticResource GreenGroupBoxStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="25"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                
                                <!-- Archivo Excel Card -->
                                <Border Grid.Column="0" Background="White" Padding="25" CornerRadius="8"
                                       BorderBrush="#E5E5E5" BorderThickness="1">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#000000" 
                                                        BlurRadius="8" 
                                                        ShadowDepth="2" 
                                                        Opacity="0.08"/>
                                    </Border.Effect>
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“Š" FontSize="36" HorizontalAlignment="Center" Margin="0,0,0,15" Foreground="#118938"/>
                                        <TextBlock Text="Archivo Excel de Cartera" 
                                                  FontFamily="Segoe UI" FontWeight="SemiBold" FontSize="16" 
                                                  HorizontalAlignment="Center" Foreground="#504F4E" Margin="0,0,0,8"/>
                                        <TextBlock Text="{Binding SelectedExcelFilePath, Converter={StaticResource PathToFileNameConverter}, TargetNullValue='NingÃºn archivo seleccionado'}" 
                                                  FontFamily="Segoe UI" FontSize="12" Foreground="#706F6F" TextWrapping="Wrap"
                                                  HorizontalAlignment="Center" TextAlignment="Center" Margin="0,0,0,15"/>
                                        <Button Content="ðŸ“‚ Seleccionar Archivo" 
                                               Style="{StaticResource AccentButtonStyle}"
                                               Padding="15,10"
                                               FontSize="13"
                                               Command="{Binding SelectExcelFileCommand}"/>
                                    </StackPanel>
                                </Border>
                                
                                <!-- Carpeta Destino Card -->
                                <Border Grid.Column="2" Background="White" Padding="25" CornerRadius="8"
                                       BorderBrush="#E5E5E5" BorderThickness="1">
                                    <Border.Effect>
                                        <DropShadowEffect Color="#000000" 
                                                        BlurRadius="8" 
                                                        ShadowDepth="2" 
                                                        Opacity="0.08"/>
                                    </Border.Effect>
                                    <StackPanel>
                                        <TextBlock Text="ðŸ“" FontSize="36" HorizontalAlignment="Center" Margin="0,0,0,15" Foreground="#118938"/>
                                        <TextBlock Text="Carpeta de Destino" 
                                                  FontFamily="Segoe UI" FontWeight="SemiBold" FontSize="16" 
                                                  HorizontalAlignment="Center" Foreground="#504F4E" Margin="0,0,0,8"/>
                                        <TextBlock Text="{Binding OutputFolderPath, TargetNullValue='Carpeta por defecto'}" 
                                                  FontFamily="Segoe UI" FontSize="12" Foreground="#706F6F" TextWrapping="Wrap"
                                                  HorizontalAlignment="Center" TextAlignment="Center" Margin="0,0,0,15"/>
                                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                            <Button Content="ðŸ“‚ Seleccionar" 
                                                   Style="{StaticResource AccentButtonStyle}"
                                                   Padding="12,8"
                                                   FontSize="12"
                                                   Margin="0,0,8,0"
                                                   Command="{Binding SelectOutputFolderCommand}"/>
                                            <Button Content="ðŸ—‚ï¸" 
                                                   Style="{StaticResource SecondaryButtonStyle}"
                                                   Width="35" Height="35"
                                                   ToolTip="Abrir carpeta"
                                                   Command="{Binding OpenOutputFolderCommand}"/>                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </GroupBox>
                          <!-- BotÃ³n de GeneraciÃ³n -->
                        <Button Content="ðŸš€ Generar Estados de Cuenta" 
                               Style="{StaticResource AccentButtonStyle}"
                               Padding="25,15"
                               FontSize="16"
                               HorizontalAlignment="Center"
                               Margin="0,10,0,20"
                               Command="{Binding GenerateDocumentsCommand}"/>

                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            
            <!-- Segunda pestaÃ±a: EnvÃ­o AutomÃ¡tico -->
            <TabItem Header="ðŸš€ EnvÃ­o AutomÃ¡tico">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        
                        <!-- ConfiguraciÃ³n SMTP -->
                        <GroupBox Header="âš™ï¸ ConfiguraciÃ³n SMTP" 
                                  Style="{StaticResource GreenGroupBoxStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- InformaciÃ³n de Estado SMTP -->
                                <StackPanel Grid.Column="0">
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <Ellipse Width="12" Height="12" Margin="0,0,8,0" VerticalAlignment="Center">
                                            <Ellipse.Fill>
                                                <SolidColorBrush Color="{Binding IsEmailConfigured, Converter={StaticResource BooleanToColorConverter}}"/>
                                            </Ellipse.Fill>
                                        </Ellipse>
                                        <TextBlock Text="{Binding IsEmailConfigured, Converter={StaticResource BooleanToStatusTextConverter}}" 
                                                  FontFamily="Segoe UI"
                                                  FontWeight="SemiBold" 
                                                  VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <!-- InformaciÃ³n detallada cuando estÃ¡ configurado -->
                                    <Grid Visibility="{Binding IsEmailConfigured, Converter={StaticResource BooleanToVisibilityConverter}}">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Usuario:" 
                                                  FontFamily="Segoe UI" FontWeight="SemiBold" 
                                                  FontSize="12" Margin="0,0,10,2"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding SmtpUsername}" 
                                                  FontFamily="Segoe UI" FontSize="12"/>
                                        
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Servidor:" 
                                                  FontFamily="Segoe UI" FontWeight="SemiBold" 
                                                  FontSize="12" Margin="0,0,10,2"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" FontFamily="Segoe UI" FontSize="12">
                                            <Run Text="{Binding SmtpServer}"/>
                                            <Run Text=":"/>
                                            <Run Text="{Binding SmtpPort}" FontWeight="SemiBold"/>
                                        </TextBlock>
                                    </Grid>

                                    <TextBlock Text="Configure el servidor SMTP para habilitar el envÃ­o automÃ¡tico"
                                              FontFamily="Segoe UI"
                                              FontSize="12" 
                                              FontStyle="Italic"
                                              Visibility="{Binding IsEmailConfigured, Converter={StaticResource InverseBooleanConverter}, ConverterParameter=Visibility}"/>
                                </StackPanel>

                                <!-- Botones de configuraciÃ³n -->
                                <StackPanel Grid.Column="1" Orientation="Vertical">
                                    <Button Content="âš™ï¸ Configurar" 
                                           Style="{StaticResource AccentButtonStyle}"
                                           Padding="20,12"
                                           FontSize="14"
                                           Margin="0,0,0,10"
                                           Click="ConfigureSmtp_Click"/>
                                    <Button Content="ðŸ§ª Probar" 
                                           Style="{StaticResource SecondaryButtonStyle}"
                                           Padding="15,8"
                                           FontSize="12"
                                           IsEnabled="{Binding IsEmailConfigured}"
                                           Command="{Binding SendTestEmailCommand}"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <!-- ConfiguraciÃ³n de EnvÃ­o -->
                        <GroupBox Header="ðŸ“Š ConfiguraciÃ³n de EnvÃ­o" 
                                  Style="{StaticResource GreenGroupBoxStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="150"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Column="0" 
                                       Content="Excel de Correos:" 
                                       FontFamily="Segoe UI"
                                       VerticalAlignment="Center"/>
                                <TextBox Grid.Column="1" 
                                         Text="{Binding SelectedEmailExcelFilePath, TargetNullValue='No se ha seleccionado archivo'}" 
                                         IsReadOnly="True"
                                         FontFamily="Segoe UI"
                                         Margin="5,0"/>
                                <Button Grid.Column="2" 
                                        Content="..." 
                                        Style="{StaticResource AccentButtonStyle}"
                                        Width="30" Height="30"
                                        Margin="5,0,0,0"
                                        Command="{Binding SelectEmailExcelFileCommand}"/>
                            </Grid>
                        </GroupBox>

                        <!-- Estado del archivo -->
                        <GroupBox Header="ðŸ“ˆ Estado del Archivo" 
                                  Style="{StaticResource GreenGroupBoxStyle}"
                                  Visibility="{Binding HasEmailExcel, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                                    <Ellipse Width="12" Height="12" Margin="0,0,8,0" VerticalAlignment="Center" Fill="#118938"/>
                                    <TextBlock Text="Archivo vÃ¡lido" 
                                              FontFamily="Segoe UI"
                                              FontWeight="SemiBold" 
                                              VerticalAlignment="Center"/>
                                </StackPanel>
                                <TextBlock FontFamily="Segoe UI" FontSize="12">
                                    <Run Text="Empresas con correo: "/>
                                    <Run Text="{Binding CompaniesWithEmail, Mode=OneWay}" FontWeight="Bold"/>
                                </TextBlock>
                            </StackPanel>
                        </GroupBox>                        <!-- AcciÃ³n de EnvÃ­o -->
                        <GroupBox Header="ðŸš€ EnvÃ­o AutomÃ¡tico" 
                                  Style="{StaticResource GreenGroupBoxStyle}">
                            <Button Content="ðŸš€ Enviar Documentos AutomÃ¡ticamente"
                                   Style="{StaticResource AccentButtonStyle}"
                                   Padding="25,12"
                                   FontSize="14"
                                   HorizontalAlignment="Center"
                                   IsEnabled="{Binding CanSendAutomatically}"
                                   Command="{Binding SendDocumentsAutomaticallyCommand}"/>
                        </GroupBox>

                    </StackPanel>
                </ScrollViewer>
            </TabItem></TabControl>
            
            </StackPanel>
        </ScrollViewer>
        
        <!-- SecciÃ³n de Progreso Fija (GeneraciÃ³n) -->
        <Border Grid.Row="1" Background="White" Padding="25,20" BorderBrush="#E5E5E5" BorderThickness="0,1,0,0"
               Visibility="{Binding IsProcessing, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Border.Effect>
                <DropShadowEffect Color="#000000" 
                                BlurRadius="6" 
                                ShadowDepth="1" 
                                Opacity="0.08"/>
            </Border.Effect>
            <StackPanel>
                <controls:SimpleProgressBar ProgressValue="{Binding ProgressValue}"
                                           Title="ðŸ”„ Generando Estados de Cuenta"
                                           StatusMessage="{Binding StatusMessage}"
                                           BackgroundColor="#FFFFFF"
                                           TitleColor="#504F4E"
                                           PercentageColor="#118938"
                                           MessageColor="#706F6F"
                                           BarForeground="#118938"
                                           BarBackground="#E5E5E5"
                                           BarHeight="20"/>                <Button Content="âŒ Cancelar GeneraciÃ³n" 
                        Style="{StaticResource CancelButtonStyle}"
                        Padding="15,10" 
                        FontSize="13"
                        HorizontalAlignment="Center"
                        Margin="0,15,0,0"
                        Command="{Binding CancelGenerationCommand}"/>
            </StackPanel>
        </Border>
          <!-- Panel de FinalizaciÃ³n Fijo -->
        <Border Grid.Row="1" Background="White" Padding="25,20" BorderBrush="#E5E5E5" BorderThickness="0,1,0,0"
               Visibility="{Binding ShowCompletionPanel, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Border.Effect>
                <DropShadowEffect Color="#000000" 
                                BlurRadius="6" 
                                ShadowDepth="1" 
                                Opacity="0.08"/>
            </Border.Effect>
            <StackPanel>
                <TextBlock Text="{Binding CompletionMessage}" 
                          FontFamily="Segoe UI"
                          FontSize="16" 
                          FontWeight="SemiBold"
                          TextWrapping="Wrap" 
                          HorizontalAlignment="Center"
                          TextAlignment="Center"
                          Foreground="#118938"
                          Margin="0,0,0,20"/>
                
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                    <Button Content="ðŸš€ Ir a EnvÃ­o de Correos" 
                           Style="{StaticResource AccentButtonStyle}"
                           Padding="25,15" 
                           FontSize="16" 
                           Margin="10"
                           Click="GoToEmailTab_Click"/>
                    <Button Content="ðŸ“‚ Ver Documentos" 
                           Style="{StaticResource SecondaryButtonStyle}"
                           Padding="20,15" 
                           FontSize="14" 
                           Margin="10"
                           Command="{Binding OpenOutputFolderCommand}"/>
                </StackPanel>
            </StackPanel>
        </Border>
        
        <!-- SecciÃ³n de Progreso Fija (EnvÃ­o de Emails) -->
        <Border Grid.Row="1" Background="White" Padding="25,20" BorderBrush="#E5E5E5" BorderThickness="0,1,0,0"
               Visibility="{Binding IsSendingEmail, Converter={StaticResource BooleanToVisibilityConverter}}">
            <Border.Effect>
                <DropShadowEffect Color="#000000" 
                                BlurRadius="6" 
                                ShadowDepth="1" 
                                Opacity="0.08"/>
            </Border.Effect>
            <StackPanel>
                <controls:SimpleProgressBar ProgressValue="{Binding EmailProgressValue}"
                                           Title="ðŸ“§ Enviando Documentos por Email"
                                           StatusMessage="{Binding EmailStatusMessage}"
                                           BackgroundColor="#FFFFFF"
                                           TitleColor="#504F4E"
                                           PercentageColor="#118938"
                                           MessageColor="#706F6F"
                                           BarForeground="#118938"
                                           BarBackground="#E5E5E5"
                                           BarHeight="20"/>
                  <Button Content="âŒ Cancelar EnvÃ­o" 
                        Style="{StaticResource CancelButtonStyle}"
                        Padding="15,10" 
                        FontSize="13"
                        HorizontalAlignment="Center"
                        Margin="0,15,0,0"
                        Command="{Binding CancelEmailSendingCommand}"/>
            </StackPanel>
        </Border>
        </Grid>
</UserControl>
